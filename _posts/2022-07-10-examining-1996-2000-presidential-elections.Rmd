---
title: "Examining the 1996--2000 Presidential Elections"
author: "Alex Nelson"
date: '2022-07-10'
output: 
  md_document:
    variant: gfm
    toc: true
    toc_depth: 4
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
library(tidyverse)

source("../R/presidential_elections.R")
```

We start by loading the state-level election results.

```{r}
state_results <- load_obj(state_path)
county_results <- load_obj(county_path)
county_fips <- county_results %>%
  filter(state_po == "LA") %>%
  select(county,FIPS) %>%
  rename(Parish=county) %>%
  unique
```

```{r}
state_results <- read.csv("../data/elections/presidential/state/1976-2020-president.csv")
```

# The 1988-2000 elections

I'm curious about the changes in voting behaviour, so we examine the results by state.

```{r}
df <- state_results %>%
  filter(year %in% c(1988,1992,1996,2000), party_simplified %in% c("DEMOCRAT", "REPUBLICAN")) %>%
  rename(party = party_simplified)
```

The margin of victory of the Democratic candidate (or the margin of loss) is what I'm currently intrigued about.

```{r}
mov_df <- df %>%
  select(-candidate,-party_detailed) %>%
  spread(party,candidatevotes) %>%
  mutate(margin = (DEMOCRAT - REPUBLICAN)/totalvotes)
```

Now I want to examine the margin for each state across the years. The margin of the nation-wide popular vote won is then:

```{r}
national_margins <- mov_df %>%
  group_by(year) %>%
  summarize(d = sum(DEMOCRAT),
            r = sum(REPUBLICAN),
            votes = sum(totalvotes)) %>%
  mutate(margin = (d - r)/votes) %>%
  select(year,margin) %>%
  spread(year,margin)

national_margins
```

We can use this to estimate the expected margin of victory by linear interpolation.

```{r}
df1 <- mov_df %>%
  select(year,state_po,margin) %>%
  spread(year,margin) %>%
  mutate(exp_1992 = `1988` + (national_margins$`1992` - national_margins$`1988`),
         exp_1996 = `1992` + (national_margins$`1996` - national_margins$`1992`),
         exp_2000 = `1996` + (national_margins$`2000` - national_margins$`1996`))
```

We find the variance of the national popular vote margin to be about 2.83% with an sd of about 1%:

```{r}
c(var(df1$`1988`),var(df1$`1992`),var(df1$`1996`),var(df1$`2000`))
c(mean((df1$`1988` - national_margins$`1988`)^2),mean((df1$`1992` - national_margins$`1992`)^2),mean((df1$`1996` - national_margins$`1996`)^2),mean((df1$`2000` - national_margins$`2000`)^2))
c(mean(c(var(df1$`1988`),var(df1$`1992`),var(df1$`1996`),var(df1$`2000`))),
  sd(c(var(df1$`1988`),var(df1$`1992`),var(df1$`1996`),var(df1$`2000`))))

c(mean(c(mean((df1$`1988` - national_margins$`1988`)^2),mean((df1$`1992` - national_margins$`1992`)^2),mean((df1$`1996` - national_margins$`1996`)^2),mean((df1$`2000` - national_margins$`2000`)^2))),
  sd(c(mean((df1$`1988` - national_margins$`1988`)^2),mean((df1$`1992` - national_margins$`1992`)^2),mean((df1$`1996` - national_margins$`1996`)^2),mean((df1$`2000` - national_margins$`2000`)^2))))


c(mean(c(var(df1$`1988`),var(df1$`1992`),var(df1$`1996`),var(df1$`2000`),mean((df1$`1988` - national_margins$`1988`)^2),mean((df1$`1992` - national_margins$`1992`)^2),mean((df1$`1996` - national_margins$`1996`)^2),mean((df1$`2000` - national_margins$`2000`)^2))),
  sd(c(var(df1$`1988`),var(df1$`1992`),var(df1$`1996`),var(df1$`2000`),mean((df1$`1988` - national_margins$`1988`)^2),mean((df1$`1992` - national_margins$`1992`)^2),mean((df1$`1996` - national_margins$`1996`)^2),mean((df1$`2000` - national_margins$`2000`)^2))))
```
# Southern States

Of particular interest are the Southern states, which oscillated from Bush to Clinton back to Bush.

```{r}
south <- df1 %>%
  filter(state_po %in% c("AR", "OK", "TX", "MS", "LA", "AL", "TN", "FL", "SC", "NC", "GA", "VA", "WV"))
```

We may observe its variance of the margin of victory is smaller than (the variance of the national) average:

```{r}
c(var(south$`1988`),var(south$`1992`),var(south$`1996`),var(south$`2000`))
c(mean(c(var(south$`1988`),var(south$`1992`),var(south$`1996`),var(south$`2000`))),
  sd(c(var(south$`1988`),var(south$`1992`),var(south$`1996`),var(south$`2000`))))
```
We see the average margin of victory in the South was D+0.1% when Clinton was running, but R+13.65% when Clinton was not running.

```{r}
summary(south)
```

# Louisiana

This was a particularly intriguing state, since it oscillated so violently.

```{r}
la88 <- read.csv("../data/elections/presidential/state/LA/1988.csv") %>%
  rename(democrat = `Dukakis...Bentsen.Democratic.Party..DEM.`,
         republican = `Bush...Quayle.Republican.Party..REP.`,
         DavidDuke = `Duke...Parker.Independent.Populist..OTH.`,
         PaulMarrou = `Paul...Marrou.Libertarian.Party..OTH.`,
         LyndonLarouche = `LaRouche...Freeman.National.Economic.Recovery..OTH.`,
         Fulani = `Fulani...Dattner.New.Alliance.Party..OTH.`) %>%
  mutate(total = democrat + republican + DavidDuke + PaulMarrou + LyndonLarouche + Fulani,
         year = 1988) %>%
  select(Parish,democrat,republican,total,year)

la92 <- read.csv("../data/elections/presidential/state/LA/1992.csv") %>%
  rename(democrat = `Clinton...Gore.Democratic.Party..DEM.`,
         republican = `Bush...Quayle.Republican.Party..REP.`,
         Gritz = `Gritz...Minett.America.First..OTH.`,
         Daniels = `Daniels...Tupahache.Equal.Justice...Opportunity..OTH.`,
         Yiamonyiannis = `Yiamonyiannis...McCone.Independent..OTH.`,
         Marrou = `Marrou...Lord.Libertarian.Party..LBT.`,
         LyndonLarouche = `LaRouche...Bevel.Justice..Industry..Agriculture..OTH.`,
         Phillips = `Phillips...Graves.Louisiana.Taxpayers.Party..OTH.`,
         Fulani = `Fulani...Munoz.More.Perfect.Democracy..OTH.`,
         Hagelin = `Hagelin...Tompkins.Natural.Law..OTH.`,
         Perot = `Perot...Stockdale.Prudence..Action..Results..OTH.`) %>%
  mutate(total = democrat + republican + Gritz + Daniels + Yiamonyiannis + Marrou + LyndonLarouche + Phillips + Fulani + Hagelin + Perot,
         year = 1992) %>%
  select(Parish,democrat,republican,Perot,total,year)

la96 <- read.csv("../data/elections/presidential/state/LA/1996.csv") %>%
  rename(democrat = `Clinton...Gore.Democratic.Party..DEM.`,
         republican = `Dole...Kemp.Republican.Party..REP.`,
         Browne = `Browne...Jorgensen.Libertarian.Party..LBT.`,
         Nader = `Nader...LaDuke.Liberty..Ecology..Community..OTH.`,
         Hagelin = `Hagelin...Tompkins.Natural.Law..OTH.`,
         Perot = `Perot...Campbell.Reform.Party..RFM.`,
         Moorehead = `Moorehead...LaRiva.Workers.World..OTH.`) %>%
  mutate(total = democrat + republican + Browne + Nader + Hagelin + Perot + Moorehead,
         year = 1996) %>%
  select(Parish,democrat,republican,Perot,total,year)

la00 <- read.csv("../data/elections/presidential/state/LA/2000.csv") %>%
  rename(democrat = `Gore...Lieberman.Democratic.Party..DEM.`,
         republican = `Bush...Cheney.Republican.Party..REP.`,
         Buchanan = `Buchanan...Foster.Reform.Party..RFM.`,
         Nader = `Nader...LaDuke.Green.Party..GRN.`,
         Phillips = `Phillips...Frazier.Constitution.Party..OTH.`,
         Browne = `Browne...Olivier.Libertarian.Party..LBT.`,
         Hagelin = `Hagelin...Ticciati.Natural.Law.Party..OTH.`,
         Harris = `Harris...Trowe.Socialist.Workers.Party..OTH.`) %>%
  mutate(year = 2000,
         total = democrat + republican + Buchanan + Nader + Phillips + Browne + Hagelin + Harris) %>%
  select(Parish,democrat,republican,Nader,total,year)

la <- rbind(select(la88,Parish,democrat,republican,total,year),
            select(la92,Parish,democrat,republican,total,year),
            select(la96,Parish,democrat,republican,total,year),
            select(la00,Parish,democrat,republican,total,year)) %>%
  mutate(margin = (democrat - republican)/total,
         third_party = total - democrat - republican)
```

We can just print out the parish-level results:

```{r}
arrange(la,Parish,year)
```

I am curious about the expected votes in each Parish. That is, just take the percent of the popular vote for the Democratic candidate (resp., Republican candidate) for the election, then multiplying by the number of votes cast in the Parish.

```{r}
la_state_results <- 
  data.frame(year=c(1988,1992,1996,2000),
             democrat=c(sum(la88$democrat),sum(la92$democrat),sum(la96$democrat),sum(la00$democrat)),
             republican=c(sum(la88$republican),sum(la92$republican),sum(la96$republican),sum(la00$republican)),
             total=c(sum(la88$total),sum(la92$total),sum(la96$total),sum(la00$total))) %>%
  mutate(d = democrat/total,
         r = republican/total)

la_state_results
```

Now we can write down the expected votes for the Democratic (resp, Republican) candidate:

```{r}
exp_la <- la %>%
  mutate(exp_dem = total*(filter(la_state_results,year==year)$d),
         exp_rep = total*(filter(la_state_results,year==year)$r))

exp_la %>% select(-third_party) %>%
  arrange(Parish,year)
```
We can enumerate the Parishes which are "expected Democrat":

```{r}
dem_parishes <- unique(c((la96 %>% mutate(exp_d = total*(sum(democrat)/sum(total))) %>% 
                            filter(exp_d <= democrat))$Parish, 
                         (la92 %>% mutate(exp_d = total*(sum(democrat)/sum(total))) %>%
                            filter(exp_d <= democrat))$Parish
                        # , (la88 %>% mutate(exp_d = total*(sum(democrat)/sum(total))) %>%
                        #    filter(exp_d <= democrat))$Parish
                         ))

filter(la00, Parish %in% dem_parishes, republican > democrat)
```
Curiously, the shift in these Parishes which Clinton won in '92 and '96 is insufficient to explain Al Gore's loss in 2000:

```{r}
sum(la00$republican)-sum(la00$democrat) # = 135527

filter(la00, Parish %in% dem_parishes, republican > democrat) %>%
  summarize(d = sum(democrat), r = sum(republican), margin = r - d)
```

There is a deficit of 98723 votes not explained by this.

```{r}
la_perc <- left_join(la88 %>% mutate(r88 = republican/total, d88 = democrat/total) %>% select(Parish,r88,d88), 
          la00 %>% mutate(r00 = republican/total, d00 = democrat/total) %>% select(Parish,r00,d00)) %>%
  mutate(delta_r = r00 - r88) %>%
  arrange(-delta_r)

la_perc
```


```{r}
la_marg <- left_join(la88 %>% mutate(r88 = republican, d88 = democrat) %>% select(Parish,r88,d88), 
          la00 %>% mutate(r00 = republican, d00 = democrat) %>% select(Parish,r00,d00)) %>%
  mutate(delta_r = r00 - r88) %>%
  arrange(-delta_r)

la_marg
```
```{r}
foo <- left_join(la88 %>% mutate(r88 = republican, d88 = democrat, m88 = (democrat - republican)/total) %>% select(Parish,r88,d88,m88), 
          la00 %>% mutate(r00 = republican, d00 = democrat, m00 = (democrat - republican)/total) %>% select(Parish,r00,d00,m00)) %>%
  mutate(delta_r = r00 - r88,
         delta_d = d00 - d88,
         delta_m = (r00 - d00) - (r88 - d88)) %>%
  arrange((m00 - m88)) %>%
  inner_join(county_fips)
foo
```

## Plotting Louisiana differences

```{r}
library(tidyverse)
library(urbnmapr)
```

We can now plot stuff:

```{r}
p <- foo %>%
  select(FIPS,delta_r) %>%
  mutate(county_fips = as.character(FIPS),
         delta_r = ifelse(delta_r > 0, (delta_r), 0)) %>%
  select(county_fips,delta_r) %>%
  left_join(counties, by = "county_fips") %>% 
  filter(state_name == "Louisiana") %>% 
  ggplot(mapping = aes(long, lat, group = group, fill = delta_r)) +
  geom_polygon(color = "#000000", size = .25) +
  coord_map(projection = "albers", lat0 = 29, lat1 = 45) +
  scale_fill_continuous(low = "white", high = "red", label = scales::comma) +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) +
  labs(title = "Increase in Republican voters (2000 vs 1988)",
       fill = "Number Voters")
jpeg("la-increase-repubs.jpeg")
p
dev.off()
p
```


```{r}
p <- foo %>%
  select(FIPS,delta_d) %>%
  mutate(county_fips = as.character(FIPS),
         delta_r = ifelse(delta_d > 0, (delta_d), 0)) %>%
  select(county_fips,delta_d) %>%
  left_join(counties, by = "county_fips") %>% 
  filter(state_name == "Louisiana") %>% 
  ggplot(mapping = aes(long, lat, group = group, fill = delta_d)) +
  geom_polygon(color = "#000000", size = .25) +
  coord_map(projection = "albers", lat0 = 29, lat1 = 45) +
  scale_fill_continuous(low = "white", high = "blue", label = scales::comma) +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) +
  labs(title = "Increase in Democratic voters (2000 vs 1988)",
       fill = "Number voters")
jpeg("la-increase-dems.jpeg")
p
dev.off()
p
```


```{r}
p <- foo %>%
  select(FIPS,delta_r,delta_d) %>%
  mutate(county_fips = as.character(FIPS),
         delta_r = ifelse(delta_r < 0, (delta_r), 0)) %>%
  select(county_fips,delta_r) %>%
  left_join(counties, by = "county_fips") %>% 
  filter(state_name == "Louisiana") %>% 
  ggplot(mapping = aes(long, lat, group = group, fill = delta_r)) +
  geom_polygon(color = "#000000", size = .25) +
  coord_map(projection = "albers", lat0 = 29, lat1 = 45) +
  scale_fill_continuous(low = "blue", high = "white", label = scales::comma) +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) +
  labs(title = "Decrease in Republican voters (2000 vs 1988)",
       fill = "Number Voters")
jpeg("la-decrease-repubs.jpeg")
p
dev.off()
p
```

```{r}
p <- foo %>%
  select(FIPS,delta_d) %>%
  mutate(county_fips = as.character(FIPS),
         delta_d = ifelse(delta_d < 0, (delta_d), 0)) %>%
  select(county_fips,delta_d) %>%
  left_join(counties, by = "county_fips") %>% 
  filter(state_name == "Louisiana") %>% 
  ggplot(mapping = aes(long, lat, group = group, fill = delta_d)) +
  geom_polygon(color = "#000000", size = .25) +
  coord_map(projection = "albers", lat0 = 29, lat1 = 45) +
  scale_fill_continuous(low = "red", high = "white", label = scales::comma) +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) +
  labs(title = "Decrease in Democratic voters (2000 vs 1988)",
       fill = "Number Voters")
jpeg("la-decrease-dems.jpeg")
p
dev.off()
p
```

## Clinton 1992

```{r}
foo92 <- left_join(la88 %>% mutate(r88 = republican,
                                   d88 = democrat,
                                   m88 = (democrat - republican)/total) %>% select(Parish,r88,d88,m88), 
          la92 %>% mutate(r92 = republican,
                          d92 = democrat,
                          m92 = (democrat - republican)/total) %>% select(Parish,r92,d92,m92)) %>%
  mutate(delta_r = r92 - r88,
         delta_d = d92 - d88,
         delta_m = (r92 - d92) - (r88 - d88)) %>%
  arrange((m92 - m88)) %>%
  inner_join(county_fips)
foo92
```


```{r}
p <- foo92 %>%
  select(FIPS,delta_r) %>%
  mutate(county_fips = as.character(FIPS),
         delta_r = ifelse(delta_r < 0, (delta_r), 0)) %>%
  select(county_fips,delta_r) %>%
  left_join(counties, by = "county_fips") %>% 
  filter(state_name == "Louisiana") %>% 
  ggplot(mapping = aes(long, lat, group = group, fill = delta_r)) +
  geom_polygon(color = "#000000", size = .25) +
  coord_map(projection = "albers", lat0 = 29, lat1 = 45) +
  scale_fill_continuous(low = "blue", high = "white", label = scales::comma) +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) +
  labs(title = "Decrease in Republican voters (1992 vs 1988)",
       fill = "Number Voters")
jpeg("la92-decrease-repubs.jpeg")
p
dev.off()
p
```


```{r}
p <- foo92 %>%
  select(FIPS,delta_d) %>%
  mutate(county_fips = as.character(FIPS),
         delta_d = ifelse(delta_d > 0, (delta_d), 0)) %>%
  select(county_fips,delta_d) %>%
  left_join(counties, by = "county_fips") %>% 
  filter(state_name == "Louisiana") %>% 
  ggplot(mapping = aes(long, lat, group = group, fill = delta_d)) +
  geom_polygon(color = "#000000", size = .25) +
  coord_map(projection = "albers", lat0 = 29, lat1 = 45) +
  scale_fill_continuous(low = "white", high = "blue", label = scales::comma) +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) +
  labs(title = "Increase in Democratic voters (1992 vs 1988)",
       fill = "Number Voters")
jpeg("la92-increase-dems.jpeg")
p
dev.off()
p
```

```{r}
p <- foo92 %>%
  select(FIPS,delta_d) %>%
  mutate(county_fips = as.character(FIPS),
         delta_d = ifelse(delta_d < 0, (delta_d), 0)) %>%
  select(county_fips,delta_d) %>%
  left_join(counties, by = "county_fips") %>% 
  filter(state_name == "Louisiana") %>% 
  ggplot(mapping = aes(long, lat, group = group, fill = delta_d)) +
  geom_polygon(color = "#000000", size = .25) +
  coord_map(projection = "albers", lat0 = 29, lat1 = 45) +
  scale_fill_continuous(low = "red", high = "white", label = scales::comma) +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) +
  labs(title = "Decrease in Democratic voters (1992 vs 1988)",
       fill = "Number Voters")
jpeg("la92-decrease-dems.jpeg")
p
dev.off()
p
```
## Clinton in 1996


```{r}
foo96 <- left_join(la96 %>% mutate(r96 = republican,
                                   d96 = democrat,
                                   m96 = (democrat - republican)/total) %>% select(Parish,r96,d96,m96), 
          la92 %>% mutate(r92 = republican,
                          d92 = democrat,
                          m92 = (democrat - republican)/total) %>% select(Parish,r92,d92,m92)) %>%
  mutate(delta_r = r96 - r92,
         delta_d = d96 - d92,
         delta_m = (r96 - d96) - (r92 - d92)) %>%
  arrange((m96 - m92)) %>%
  inner_join(county_fips)
foo96
```
```{r}
p <- foo96 %>%
  select(FIPS,delta_r) %>%
  mutate(county_fips = as.character(FIPS),
         delta_r = ifelse(delta_r < 0, (delta_r), 0)) %>%
  select(county_fips,delta_r) %>%
  left_join(counties, by = "county_fips") %>% 
  filter(state_name == "Louisiana") %>% 
  ggplot(mapping = aes(long, lat, group = group, fill = delta_r)) +
  geom_polygon(color = "#000000", size = .25) +
  coord_map(projection = "albers", lat0 = 29, lat1 = 45) +
  scale_fill_continuous(low = "blue", high = "white", label = scales::comma) +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) +
  labs(title = "Decrease in Republican voters (1996 vs 1992)",
       fill = "Number Voters")
jpeg("la96-decrease-repubs.jpeg")
p
dev.off()
p
```
```{r}
p <- foo96 %>%
  select(FIPS,delta_d) %>%
  mutate(county_fips = as.character(FIPS),
         delta_d = ifelse(delta_d < 0, (delta_d), 0)) %>%
  select(county_fips,delta_d) %>%
  left_join(counties, by = "county_fips") %>% 
  filter(state_name == "Louisiana") %>% 
  ggplot(mapping = aes(long, lat, group = group, fill = delta_d)) +
  geom_polygon(color = "#000000", size = .25) +
  coord_map(projection = "albers", lat0 = 29, lat1 = 45) +
  scale_fill_continuous(low = "red", high = "white", label = scales::comma) +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) +
  labs(title = "Decrease in Democratic voters (1996 vs 1992)",
       fill = "Number Voters")
jpeg("la96-decrease-dems.jpeg")
p
dev.off()
p
```

```{r}
p <- foo96 %>%
  select(FIPS,delta_d) %>%
  mutate(county_fips = as.character(FIPS),
         delta_d = ifelse(delta_d > 0, (delta_d), 0)) %>%
  select(county_fips,delta_d) %>%
  left_join(counties, by = "county_fips") %>% 
  filter(state_name == "Louisiana") %>% 
  ggplot(mapping = aes(long, lat, group = group, fill = delta_d)) +
  geom_polygon(color = "#000000", size = .25) +
  coord_map(projection = "albers", lat0 = 29, lat1 = 45) +
  scale_fill_continuous(low = "white", high = "blue", label = scales::comma) +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) +
  labs(title = "Increase in Democratic voters (1996 vs 1992)",
       fill = "Number Voters")
jpeg("la96-increase-dems.jpeg")
p
dev.off()
p
```
```{r}
p <- foo96 %>%
  select(FIPS,delta_r) %>%
  mutate(county_fips = as.character(FIPS),
         delta_r = ifelse(delta_r > 0, (delta_r), 0)) %>%
  select(county_fips,delta_r) %>%
  left_join(counties, by = "county_fips") %>% 
  filter(state_name == "Louisiana") %>% 
  ggplot(mapping = aes(long, lat, group = group, fill = delta_r)) +
  geom_polygon(color = "#000000", size = .25) +
  coord_map(projection = "albers", lat0 = 29, lat1 = 45) +
  scale_fill_continuous(low = "white", high = "red", label = scales::comma) +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) +
  labs(title = "Increase in Republican voters (1996 vs 1992)",
       fill = "Number Voters")
jpeg("la96-increase-repubs.jpeg")
p
dev.off()
p
```

## George W Bush


```{r}
foo00 <- left_join(la96 %>% mutate(r96 = republican,
                                   d96 = democrat,
                                   m96 = (democrat - republican)/total) %>% select(Parish,r96,d96,m96), 
          la00 %>% mutate(r00 = republican,
                          d00 = democrat,
                          m00 = (democrat - republican)/total) %>% select(Parish,r00,d00,m00)) %>%
  mutate(delta_r = r00 - r96,
         delta_d = d00 - d96,
         delta_m = (r00 - d00) - (r96 - d96)) %>%
  arrange((m00 - m96)) %>%
  inner_join(county_fips)
foo00
```
```{r}
p <- foo00 %>%
  select(FIPS,delta_r) %>%
  mutate(county_fips = as.character(FIPS),
         delta_r = ifelse(delta_r < 0, (delta_r), 0)) %>%
  select(county_fips,delta_r) %>%
  left_join(counties, by = "county_fips") %>% 
  filter(state_name == "Louisiana") %>% 
  ggplot(mapping = aes(long, lat, group = group, fill = delta_r)) +
  geom_polygon(color = "#000000", size = .25) +
  coord_map(projection = "albers", lat0 = 29, lat1 = 45) +
  scale_fill_continuous(low = "blue", high = "white", label = scales::comma) +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) +
  labs(title = "Decrease in Republican voters (2000 vs 1996)",
       fill = "Number Voters")
jpeg("la00-decrease-repubs.jpeg")
p
dev.off()
p
```
```{r}
p <- foo00 %>%
  select(FIPS,delta_d) %>%
  mutate(county_fips = as.character(FIPS),
         delta_d = ifelse(delta_d < 0, (delta_d), 0)) %>%
  select(county_fips,delta_d) %>%
  left_join(counties, by = "county_fips") %>% 
  filter(state_name == "Louisiana") %>% 
  ggplot(mapping = aes(long, lat, group = group, fill = delta_d)) +
  geom_polygon(color = "#000000", size = .25) +
  coord_map(projection = "albers", lat0 = 29, lat1 = 45) +
  scale_fill_continuous(low = "red", high = "white", label = scales::comma) +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) +
  labs(title = "Decrease in Democratic voters (2000 vs 1996)",
       fill = "Number Voters")
jpeg("la00-decrease-dems.jpeg")
p
dev.off()
p
```

```{r}
p <- foo00 %>%
  select(FIPS,delta_r) %>%
  mutate(county_fips = as.character(FIPS),
         delta_r = ifelse(delta_r > 0, (delta_r), 0)) %>%
  select(county_fips,delta_r) %>%
  left_join(counties, by = "county_fips") %>% 
  filter(state_name == "Louisiana") %>% 
  ggplot(mapping = aes(long, lat, group = group, fill = delta_r)) +
  geom_polygon(color = "#000000", size = .25) +
  coord_map(projection = "albers", lat0 = 29, lat1 = 45) +
  scale_fill_continuous(low = "white", high = "red", label = scales::comma) +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) +
  labs(title = "Increase in Republican voters (2000 vs 1996)",
       fill = "Number Voters")
jpeg("la00-increase-repubs.jpeg")
p
dev.off()
p
```
```{r}
p <- foo00 %>%
  select(FIPS,delta_d) %>%
  mutate(county_fips = as.character(FIPS),
         delta_d = ifelse(delta_d > 0, (delta_d), 0)) %>%
  select(county_fips,delta_d) %>%
  left_join(counties, by = "county_fips") %>% 
  filter(state_name == "Louisiana") %>% 
  ggplot(mapping = aes(long, lat, group = group, fill = delta_d)) +
  geom_polygon(color = "#000000", size = .25) +
  coord_map(projection = "albers", lat0 = 29, lat1 = 45) +
  scale_fill_continuous(low = "white", high = "blue", label = scales::comma) +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) +
  labs(title = "Increase in Democratic voters (2000 vs 1996)",
       fill = "Number Voters")
jpeg("la00-increase-dems.jpeg")
p
dev.off()
p
```
## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
