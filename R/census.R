categorize <- function(census_df) {
  census_df %>% transmute(
    name = NAME,
    FIPS = GEOID,
    state = state,
    male = male.18_19E + male.20E + male.21E + male.22_24E + male.25_29E + male.30_34E + male.35_39E + male.40_44E + male.45_49E + male.50_54E + male.55_59E + male.60_61E + male.62_64E + male.65_66E+male.67_69E+male.70_74E+male.75_79E+male.80_84E+male.85_plusE,
    female = female.18_19E + female.20E + female.21E + female.22_24E + female.25_29E + female.30_34E + female.35_39E + female.40_44E + female.45_49E + female.50_54E + female.55_59E + female.60_61E + female.62_64E + female.65_66E+female.67_69E+female.70_74E+female.75_79E+female.80_84E+female.85_plusE,
    # age
    age_18_19 = male.18_19E+female.18_19E,
    age_20 = male.20E+female.20E,
    age_21 = male.21E+female.21E,
    age_22_24 = male.22_24E+female.22_24E,
    age_25_29 = male.25_29E+female.25_29E,
    age_30_34 = male.30_34E+female.30_34E,
    age_35_39 = male.35_39E+female.35_39E,
    age_40_44 = male.40_44E+female.40_44E,
    age_45_49 = male.45_49E+female.45_49E,
    age_50_54 = male.50_54E+female.50_54E,
    age_55_59 = male.55_59E+female.55_59E,
    age_60_61 = male.60_61E+female.60_61E,
    age_62_64 = male.62_64E+female.62_64E,
    age_retirees = male.65_66E+male.67_69E+male.70_74E+male.75_79E+male.80_84E+male.85_plusE+female.65_66E+female.67_69E+female.70_74E+female.75_79E+female.80_84E+female.85_plusE,
    age_18_24 = age_18_19 + age_20 + age_21 + age_22_24,
    age_30_39 = age_30_34 + age_35_39,
    age_40_49 = age_40_44 + age_45_49,
    age_50_64 = age_50_54 + age_55_59 + age_60_61 + age_62_64,
    voting_age = age_18_19 + age_20 + age_21 + age_22_24 + age_25_29 + age_30_34 + age_35_39 + age_40_44 + age_45_49 + age_50_54 + age_55_59 + age_60_61 + age_62_64 + age_retirees,
    # ethnicity
    white_male = male.white_only.18_19E+male.white_only.20_24E+male.white_only.25_29E+male.white_only.30_34E+male.white_only.35_44E+male.white_only.45_54E+male.white_only.55_64E+male.white_only.65_74E+male.white_only.75_84E + male.white_only.85_plusE + 0*abs(round(rnorm(1,0,max(1,sqrt((male.white_only.18_19M**2) + (male.white_only.20_24M**2) + (male.white_only.25_29M**2) + (male.white_only.30_34M**2) + (male.white_only.35_44M**2) + (male.white_only.45_54M**2) + (male.white_only.55_64M**2) + (male.white_only.65_74M**2) + (male.white_only.75_84M**2) + (male.white_only.85_plusM**2)))))),
    white_female = female.white_only.18_19E+female.white_only.20_24E+female.white_only.25_29E+female.white_only.30_34E+female.white_only.35_44E+female.white_only.45_54E+female.white_only.55_64E+female.white_only.65_74E+female.white_only.75_84E + 0*abs(round(rnorm(1,0,max(1,sqrt((female.white_only.18_19M**2) + (female.white_only.20_24M**2) + (female.white_only.25_29M**2) + (female.white_only.30_34M**2) + (female.white_only.35_44M**2) + (female.white_only.45_54M**2) + (female.white_only.55_64M**2) + (female.white_only.65_74M**2) + (female.white_only.75_84M**2) + (female.white_only.85_plusM**2)))))),
    black_male = male.black.18_19E+male.black.20_24E+male.black.25_29E+male.black.30_34E+male.black.35_44E+male.black.45_54E+male.black.55_64E+male.black.65_74E+male.black.75_84E+male.black.85_plusE + 0*abs(round(rnorm(1,0,max(1,sqrt((male.black.18_19M**2) + (male.black.20_24M**2) + (male.black.25_29M**2) + (male.black.30_34M**2) + (male.black.35_44M**2) + (male.black.45_54M**2) + (male.black.55_64M**2) + (male.black.65_74M**2) + (male.black.75_84M**2) + (male.black.85_plusM**2)))))),
    black_female = female.black.18_19E+female.black.20_24E+female.black.25_29E+female.black.30_34E+female.black.35_44E+female.black.45_54E+female.black.55_64E+female.black.65_74E+female.black.75_84E+female.black.85_plusE + 0*abs(round(rnorm(1,0,max(1,abs(round(sqrt((female.black.18_19M**2) + (female.black.20_24M**2) + (female.black.25_29M**2) + (female.black.30_34M**2) + (female.black.35_44M**2) + (female.black.45_54M**2) + (female.black.55_64M**2) + (female.black.65_74M**2) + (female.black.75_84M**2) + (female.black.85_plusM**2)))))))),
    hispanic_male = male.hispanic.18_19E+male.hispanic.20_24E+male.hispanic.25_29E+male.hispanic.30_34E+male.hispanic.35_44E+male.hispanic.45_54E+male.hispanic.55_64E+male.hispanic.65_74E+male.hispanic.75_84E+male.hispanic.85_plusE,
    hispanic_female = female.hispanic.18_19E+female.hispanic.20_24E+female.hispanic.25_29E+female.hispanic.30_34E+female.hispanic.35_44E+female.hispanic.45_54E+female.hispanic.55_64E+female.hispanic.65_74E+female.hispanic.75_84E+female.hispanic.85_plusE,
    others_but_asians = male.american_indian.18_19E+male.american_indian.20_24E+male.american_indian.25_29E+male.american_indian.30_34E+male.american_indian.35_44E+male.american_indian.45_54E+male.american_indian.55_64E+male.american_indian.65_74E+male.american_indian.75_84E+male.american_indian.85_plusE+female.american_indian.18_19E+female.american_indian.20_24E+female.american_indian.25_29E+female.american_indian.30_34E+female.american_indian.35_44E+female.american_indian.45_54E+female.american_indian.55_64E+female.american_indian.65_74E+female.american_indian.75_84E+female.american_indian.85_plusE+male.pacific_islander.18_19E+male.pacific_islander.20_24E+male.pacific_islander.25_29E+male.pacific_islander.30_34E+male.pacific_islander.35_44E+male.pacific_islander.45_54E+male.pacific_islander.55_64E+male.pacific_islander.65_74E+male.pacific_islander.75_84E+male.pacific_islander.85_plusE+female.pacific_islander.18_19E+female.pacific_islander.20_24E+female.pacific_islander.25_29E+female.pacific_islander.30_34E+female.pacific_islander.35_44E+female.pacific_islander.45_54E+female.pacific_islander.55_64E+female.pacific_islander.65_74E+female.pacific_islander.75_84E+female.pacific_islander.85_plusE,
    asian_male = male.asian.18_19E+male.asian.20_24E+male.asian.25_29E+male.asian.30_34E+male.asian.35_44E+male.asian.45_54E+male.asian.55_64E+male.asian.65_74E+male.asian.75_84E+male.asian.85_plusE,
    asian_female=female.asian.18_19E+female.asian.20_24E+female.asian.25_29E+female.asian.30_34E+female.asian.35_44E+female.asian.45_54E+female.asian.55_64E+female.asian.65_74E+female.asian.75_84E+female.asian.85_plusE,
    others = others_but_asians + asian_male + asian_female,
    
    # ethnicity by age and gender
    white_male_18_29 = male.white_only.18_19E+male.white_only.20_24E+male.white_only.25_29E,
    white_male_30_44 = male.white_only.30_34E+male.white_only.35_44E,
    white_male_45_64 = male.white_only.45_54E+male.white_only.55_64E,
    white_male_retirees = male.white_only.65_74E+male.white_only.75_84E + male.white_only.85_plusE,
    white_female_18_29 = female.white_only.18_19E+female.white_only.20_24E+female.white_only.25_29E,
    white_female_30_44 = female.white_only.30_34E+female.white_only.35_44E,
    white_female_45_64 = female.white_only.45_54E+female.white_only.55_64E,
    white_female_retirees = female.white_only.65_74E+female.white_only.75_84E,
    black_male_18_29 = male.black.18_19E+male.black.20_24E+male.black.25_29E,
    black_male_30_44 = male.black.30_34E+male.black.35_44E,
    black_male_45_64 = male.black.45_54E+male.black.55_64E,
    black_male_retirees = male.black.65_74E+male.black.75_84E+male.black.85_plusE,
    black_female_18_29 = female.black.18_19E+female.black.20_24E+female.black.25_29E,
    black_female_30_44 = female.black.30_34E+female.black.35_44E,
    black_female_45_64 = female.black.45_54E+female.black.55_64E,
    black_female_retirees = female.black.65_74E+female.black.75_84E+female.black.85_plusE,
    hispanic_male_18_29 = male.hispanic.18_19E+male.hispanic.20_24E+male.hispanic.25_29E,
    hispanic_male_30_44 = male.hispanic.30_34E+male.hispanic.35_44E,
    hispanic_male_45_64 = male.hispanic.45_54E+male.hispanic.55_64E,
    hispanic_male_retirees = male.hispanic.65_74E+male.hispanic.75_84E+male.hispanic.85_plusE,
    hispanic_female_18_29 = female.hispanic.18_19E+female.hispanic.20_24E+female.hispanic.25_29E,
    hispanic_female_30_44 = female.hispanic.30_34E+female.hispanic.35_44E,
    hispanic_female_45_64 = female.hispanic.45_54E+female.hispanic.55_64E,
    hispanic_female_retirees = female.hispanic.65_74E+female.hispanic.75_84E+female.hispanic.85_plusE,
    others_male_18_29 = male.american_indian.18_19E+male.american_indian.20_24E+male.american_indian.25_29E + male.asian.18_19E+male.asian.20_24E+male.asian.25_29E + male.pacific_islander.18_19E+male.pacific_islander.20_24E+male.pacific_islander.25_29E,
    others_female_18_29 = female.american_indian.18_19E+female.american_indian.20_24E+female.american_indian.25_29E + female.asian.18_19E+female.asian.20_24E+female.asian.25_29E + female.pacific_islander.18_19E+female.pacific_islander.20_24E+female.pacific_islander.25_29E,
    others_male_30_44 = male.american_indian.30_34E+male.american_indian.35_44E + male.asian.30_34E+male.asian.35_44E + male.pacific_islander.30_34E+male.pacific_islander.35_44E,
    others_female_30_44 = female.american_indian.30_34E+female.american_indian.35_44E + female.asian.30_34E+female.asian.35_44E +  female.pacific_islander.30_34E+female.pacific_islander.35_44E,
    others_male_45_64 = male.american_indian.45_54E+male.american_indian.55_64E + male.asian.45_54E+male.asian.55_64E + male.pacific_islander.45_54E+male.pacific_islander.55_64E,
    others_female_45_64 = female.american_indian.45_54E+female.american_indian.55_64E + female.asian.45_54E+female.asian.55_64E + female.pacific_islander.45_54E+female.pacific_islander.55_64E,
    others_male_retirees = male.american_indian.65_74E+male.american_indian.75_84E+male.american_indian.85_plusE + male.asian.65_74E+male.asian.75_84E+male.asian.85_plusE + male.pacific_islander.65_74E+male.pacific_islander.75_84E+male.pacific_islander.85_plusE,
    others_female_retirees = female.american_indian.65_74E+female.american_indian.75_84E+female.american_indian.85_plusE + female.asian.65_74E+female.asian.75_84E+female.asian.85_plusE + female.pacific_islander.65_74E+female.pacific_islander.75_84E+female.pacific_islander.85_plusE,
    # education by gender
    education_high_school_male = male.18_24.less_than_9th_gradeE +  male.18_24.less_than_high_schoolE +  male.18_24.high_school_gradE +  male.25_34.less_than_9th_gradeE +  male.25_34.less_than_high_schoolE +  male.25_34.high_school_gradE +  male.35_44.less_than_9th_gradeE +  male.35_44.less_than_high_schoolE +  male.35_44.high_school_gradE +  male.45_64.less_than_9th_gradeE +  male.45_64.less_than_high_schoolE +  male.45_64.high_school_gradE +  male.65_plus.less_than_9th_gradeE +  male.65_plus.less_than_high_schoolE +  male.65_plus.high_school_gradE,
    education_high_school_female = female.18_24.less_than_9th_gradeE+female.18_24.less_than_high_schoolE+female.18_24.high_school_gradE +  female.25_34.less_than_9th_gradeE +  female.25_34.less_than_high_schoolE +  female.25_34.high_school_gradE +  female.35_44.less_than_9th_gradeE +  female.35_44.less_than_high_schoolE +  female.35_44.high_school_gradE +  female.45_64.less_than_9th_gradeE +  female.45_64.less_than_high_schoolE +  female.45_64.high_school_gradE +  female.65_plus.less_than_9th_gradeE +  female.65_plus.less_than_high_schoolE +  female.65_plus.high_school_gradE,
    education_some_college_male = male.18_24.some_collegeE + male.25_34.some_collegeE + male.35_44.some_collegeE + male.45_64.some_collegeE + male.65_plus.some_collegeE,
    education_some_college_female = female.18_24.some_collegeE + female.25_34.some_collegeE + female.35_44.some_collegeE + female.45_64.some_collegeE + female.65_plus.some_collegeE,
    education_assoc_degree_male = male.18_24.associate_degreeE + male.25_34.associate_degreeE + male.35_44.associate_degreeE + male.45_64.associate_degreeE + male.65_plus.associate_degreeE,
    education_assoc_degree_female = female.18_24.associate_degreeE + female.25_34.associate_degreeE + female.35_44.associate_degreeE + female.45_64.associate_degreeE + female.65_plus.associate_degreeE,
    education_college_grad_male = male.18_24.bachelor_degreeE + male.25_34.bachelor_degreeE + male.35_44.bachelor_degreeE + male.45_64.bachelor_degreeE + male.65_plus.bachelor_degreeE,
    education_college_grad_female = female.18_24.bachelor_degreeE + female.25_34.bachelor_degreeE + female.35_44.bachelor_degreeE + female.45_64.bachelor_degreeE + female.65_plus.bachelor_degreeE,
    education_postgrad_male = male.18_24.graduate_degreeE + male.25_34.graduate_degreeE + male.35_44.graduate_degreeE + male.45_64.graduate_degreeE + male.65_plus.graduate_degreeE,
    education_postgrad_female = female.18_24.graduate_degreeE + female.25_34.graduate_degreeE + female.35_44.graduate_degreeE + female.45_64.graduate_degreeE + female.65_plus.graduate_degreeE,
    # education
    education_high_school = education_high_school_male + education_high_school_female,
    education_assoc_degree = education_assoc_degree_male + education_assoc_degree_female,
    education_some_college = education_some_college_male + education_some_college_female,
    education_college_grad = education_college_grad_male + education_college_grad_female,
    education_postgrad = education_postgrad_male + education_postgrad_female
    )
}